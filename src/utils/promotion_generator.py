"""
Promotion Generator ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ï‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
‡∏ó‡∏µ‡πà‡∏î‡∏π‡πÄ‡∏õ‡πá‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏ô‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠ (‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á)
"""

import random
from typing import Dict, List
from datetime import datetime

class PromotionGenerator:
    """‡∏Ñ‡∏•‡∏≤‡∏™‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ï‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥"""
    
    def __init__(self):
        # ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥
        self.natural_openings = [
            "‡πÄ‡∏û‡∏¥‡πà‡∏á‡πÄ‡∏à‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏î‡∏µ‡πÜ ‡∏°‡∏≤‡πÅ‡∏ä‡∏£‡πå",
            "‡∏´‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏à‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏ô‡∏µ‡πâ",
            "‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏î‡∏µ‡∏à‡∏£‡∏¥‡∏á",
            "‡πÄ‡∏à‡∏≠‡∏Ç‡∏≠‡∏á‡∏î‡∏µ‡∏°‡∏≤‡∏ö‡∏≠‡∏Å‡∏ï‡πà‡∏≠",
            "‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô‡∏ñ‡∏≤‡∏°",
            "‡∏°‡∏µ‡∏Ñ‡∏ô‡∏ñ‡∏≤‡∏°‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏ö‡∏≠‡∏Å‡∏Å‡∏±‡∏ô‡∏Ñ‡πà‡∏∞",
            "‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Æ‡∏¥‡∏ï",
            "‡πÅ‡∏ä‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏î‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö"
        ]
        
        # ‡∏Ñ‡∏≥‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡∏Ç‡πâ‡∏≠‡∏î‡∏µ (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡∏≤‡∏∞‡∏à‡∏á)
        self.product_benefits = {
            '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏°‡∏ß': [
                "‡πÅ‡∏°‡∏ß‡∏Å‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏Ç‡∏ô‡πÄ‡∏á‡∏≤‡∏á‡∏≤‡∏°",
                "‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡πà‡∏≠‡∏¢‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô", 
                "‡∏°‡∏µ‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô‡∏™‡∏π‡∏á ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡πÅ‡∏°‡∏ß‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏¢",
                "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏µ‡∏ú‡∏™‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢",
                "‡πÅ‡∏°‡∏ß‡∏ä‡∏≠‡∏ö‡∏Å‡∏¥‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠",
                "‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô"
            ],
            '‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û': [
                "‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ",
                "‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏ó‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏™‡∏Ç‡∏°",
                "‡πÄ‡∏´‡πá‡∏ô‡∏ú‡∏•‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 2 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå",
                "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á",
                "‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô"
            ],
            '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡∏≤‡∏°': [
                "‡∏ú‡∏¥‡∏ß‡πÄ‡∏ô‡∏µ‡∏¢‡∏ô‡πÉ‡∏™‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏î‡πâ‡∏ä‡∏±‡∏î",
                "‡πÑ‡∏°‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ú‡∏¥‡∏ß‡πÅ‡∏û‡πâ ‡πÅ‡∏°‡πâ‡∏ú‡∏¥‡∏ß‡πÅ‡∏û‡πâ‡∏á‡πà‡∏≤‡∏¢",
                "‡∏ã‡∏∂‡∏°‡∏ã‡∏≤‡∏ö‡πÄ‡∏£‡πá‡∏ß ‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß‡πÄ‡∏´‡∏ô‡∏≠‡∏∞‡∏´‡∏ô‡∏∞",
                "‡∏Å‡∏•‡∏¥‡πà‡∏ô‡∏´‡∏≠‡∏°‡∏≠‡πà‡∏≠‡∏ô‡πÜ ‡πÑ‡∏°‡πà‡∏â‡∏∏‡∏ô",
                "‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏ú‡∏¥‡∏ß‡∏ä‡∏∏‡πà‡∏°‡∏ä‡∏∑‡πâ‡∏ô"
            ],
            '‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå': [
                "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡πÉ‡∏Ñ‡∏£‡πÜ ‡∏Å‡πá‡∏ó‡∏≥‡πÑ‡∏î‡πâ",
                "‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏î‡∏µ ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏ô‡∏≤‡∏ô",
                "‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô",
                "‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡πÄ‡∏£‡πá‡∏ß ‡πÑ‡∏°‡πà‡∏Ñ‡πâ‡∏≤‡∏á",
                "‡∏Å‡∏≤‡∏£‡∏±‡∏ô‡∏ï‡∏µ‡∏®‡∏π‡∏ô‡∏¢‡πå‡πÑ‡∏ó‡∏¢"
            ]
        }
        
        # ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏£‡∏≤‡∏Ñ‡∏≤ (‡πÄ‡∏õ‡πá‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥)
        self.price_phrases = [
            "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Å‡πá‡πÑ‡∏°‡πà‡πÅ‡∏û‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ",
            "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û",
            "‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏∑‡πà‡∏ô‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡πÇ‡∏≠‡πÄ‡∏Ñ",
            "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏™‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏°‡∏ú‡∏•",
            "‡πÉ‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ",
            "‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏ü‡∏£‡πå‡∏û‡∏≠‡∏™‡∏°‡∏Ñ‡∏ß‡∏£"
        ]
        
        # ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤
        self.shop_credibility = [
            "‡∏£‡πâ‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ ‡∏°‡∏µ‡∏Ñ‡∏ô‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡πÄ‡∏¢‡∏≠‡∏∞",
            "‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏ï‡∏≠‡∏ö‡πÄ‡∏£‡πá‡∏ß ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏î‡∏µ",
            "‡∏£‡πâ‡∏≤‡∏ô‡πÉ‡∏´‡∏ç‡πà ‡∏ô‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠",
            "‡∏™‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÑ‡∏ß ‡∏°‡∏≤‡∏Ñ‡∏£‡∏ö‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á",
            "‡∏£‡πâ‡∏≤‡∏ô‡∏°‡∏µ‡∏Ñ‡∏ô‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏¢‡∏≠‡∏∞ ‡∏Ñ‡∏á‡πÑ‡∏°‡πà‡∏ú‡∏¥‡∏î‡∏´‡∏ß‡∏±‡∏á"
        ]
        
        # ‡∏Ñ‡∏≥‡∏õ‡∏¥‡∏î‡∏ó‡πâ‡∏≤‡∏¢ (‡πÄ‡∏õ‡πá‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥)
        self.natural_endings = [
            "‡πÉ‡∏Ñ‡∏£‡∏™‡∏ô‡πÉ‡∏à‡∏•‡∏≠‡∏á‡∏î‡∏π‡∏ô‡∏∞‡∏Ñ‡∏∞",
            "‡πÅ‡∏ä‡∏£‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏≠‡∏¢‡∏π‡πà",
            "‡∏´‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏•‡∏≠‡∏á‡∏î‡∏π‡πÄ‡∏à‡πâ‡∏≤‡∏ô‡∏µ‡πâ",
            "‡πÉ‡∏Ñ‡∏£‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏´‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏•‡∏¢",
            "‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏Å‡πá‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ô‡∏ô‡∏∞",
            "‡∏´‡∏ß‡∏±‡∏á‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏î‡πâ‡∏ô‡∏∞‡∏Ñ‡∏∞"
        ]
        
        # Hashtags ‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥
        self.natural_hashtags = [
            "#‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏Ç‡∏≠‡∏á‡∏î‡∏µ", "#‡πÅ‡∏ä‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏î‡∏µ", "#‡∏Ç‡∏≠‡∏á‡∏î‡∏µ‡∏ö‡∏≠‡∏Å‡∏ï‡πà‡∏≠",
            "#‡πÉ‡∏ä‡πâ‡∏î‡∏µ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥", "#‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏î‡∏µ", "#‡∏£‡∏≤‡∏Ñ‡∏≤‡∏î‡∏µ",
            "#shopee", "#‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏µ‡πâ", "#‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå"
        ]

    def generate_promotion(self, product: Dict, style: str = "casual") -> str:
        """‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ï‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
        
        Args:
            product: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
            style: ‡∏™‡πÑ‡∏ï‡∏•‡πå - casual, enthusiastic, informative
        """
        try:
            product_name = product.get('product_name', '')
            price = float(product.get('price', 0))
            shop_name = product.get('shop_name', '')
            rating = float(product.get('rating', 0))
            sold_count = int(product.get('sold_count', 0))
            category = product.get('category', '')
            
            # ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ï‡∏≤‡∏°‡∏™‡πÑ‡∏ï‡∏•‡πå
            if style == "casual":
                return self._generate_casual_promotion(product_name, price, shop_name, rating, sold_count, category)
            elif style == "enthusiastic":
                return self._generate_enthusiastic_promotion(product_name, price, shop_name, rating, sold_count, category)
            else:  # informative
                return self._generate_informative_promotion(product_name, price, shop_name, rating, sold_count, category)
                
        except Exception as e:
            return f"‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ {product.get('product_name', '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏î‡∏µ‡πÜ')} \n‡∏£‡∏≤‡∏Ñ‡∏≤ {product.get('price', 0)} ‡∏ö‡∏≤‡∏ó\n‡πÉ‡∏Ñ‡∏£‡∏™‡∏ô‡πÉ‡∏à‡∏•‡∏≠‡∏á‡∏î‡∏π‡∏ô‡∏∞‡∏Ñ‡∏∞"

    def _generate_casual_promotion(self, name: str, price: float, shop: str, rating: float, sold: int, category: str) -> str:
        """‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ï‡πÅ‡∏ö‡∏ö‡∏™‡∏ö‡∏≤‡∏¢‡πÜ ‡πÄ‡∏õ‡πá‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥"""
        
        # ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡πÄ‡∏õ‡∏¥‡∏î
        opening = random.choice(self.natural_openings)
        
        # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏¢‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢)
        short_name = self._shorten_product_name(name)
        
        # ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏î‡∏µ
        benefits = self._get_category_benefits(category)
        benefit = random.choice(benefits) if benefits else "‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏î‡∏µ ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á"
        
        # ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏£‡∏≤‡∏Ñ‡∏≤
        price_desc = random.choice(self.price_phrases)
        
        # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
        shop_desc = ""
        if shop:
            shop_desc = f"\n‡∏£‡πâ‡∏≤‡∏ô {shop} " + random.choice(self.shop_credibility)
        
        # ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
        stats = ""
        if sold > 1000:
            stats = f"\n‡∏Ç‡∏≤‡∏¢‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß {self._format_sold_count(sold)} "
        if rating >= 4.0:
            stars = "‚≠ê" * int(rating)
            stats += f" {stars} ({rating})"
        
        # ‡∏Ñ‡∏≥‡∏õ‡∏¥‡∏î‡∏ó‡πâ‡∏≤‡∏¢
        ending = random.choice(self.natural_endings)
        
        # Hashtags
        hashtags = random.sample(self.natural_hashtags, 3)
        hashtag_str = " ".join(hashtags)
        
        promotion = f"""{opening} üòä

üì¶ {short_name}
üí∞ {price:,.0f} ‡∏ö‡∏≤‡∏ó - {price_desc}
‚ú® {benefit}{shop_desc}{stats}

{ending}

{hashtag_str}"""
        
        return promotion

    def _generate_enthusiastic_promotion(self, name: str, price: float, shop: str, rating: float, sold: int, category: str) -> str:
        """‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ï‡πÅ‡∏ö‡∏ö‡∏Å‡∏£‡∏∞‡∏ï‡∏∑‡∏≠‡∏£‡∏∑‡∏≠‡∏£‡πâ‡∏ô"""
        
        short_name = self._shorten_product_name(name)
        benefits = self._get_category_benefits(category)
        
        promotion = f"""üî• ‡πÄ‡∏à‡∏≠‡∏Ç‡∏≠‡∏á‡∏î‡∏µ‡∏°‡∏≤‡πÅ‡∏ä‡∏£‡πå! üî•

‚ú® {short_name} ‚ú®
üí∏ ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏û‡∏µ‡∏¢‡∏á {price:,.0f} ‡∏ö‡∏≤‡∏ó!

üëç {random.choice(benefits) if benefits else '‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÄ‡∏Å‡∏¥‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤!'}
üè™ ‡∏£‡πâ‡∏≤‡∏ô {shop} ‡∏°‡∏µ‡∏Ñ‡∏ô‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏¢‡∏≠‡∏∞‡∏°‡∏≤‡∏Å!"""

        if sold > 5000:
            promotion += f"\nüî• ‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏ß‡πà‡∏≤ {self._format_sold_count(sold)}"
        
        if rating >= 4.5:
            promotion += f"\n‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô {rating} ‡∏î‡∏≤‡∏ß!"

        promotion += f"""

üõí ‡πÉ‡∏Ñ‡∏£‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏´‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏•‡∏≠‡∏á!
üíï ‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ú‡∏¥‡∏î‡∏´‡∏ß‡∏±‡∏á!

{' '.join(random.sample(self.natural_hashtags, 4))}"""
        
        return promotion

    def _generate_informative_promotion(self, name: str, price: float, shop: str, rating: float, sold: int, category: str) -> str:
        """‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ï‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"""
        
        short_name = self._shorten_product_name(name)
        benefits = self._get_category_benefits(category)
        
        promotion = f"""üìã ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: {short_name}

üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:
‚Ä¢ ‡∏£‡∏≤‡∏Ñ‡∏≤: {price:,.0f} ‡∏ö‡∏≤‡∏ó
‚Ä¢ ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤: {shop}"""

        if rating > 0:
            promotion += f"\n‚Ä¢ ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏µ‡∏ß‡∏¥‡∏ß: {rating}/5.0 ‚≠ê"
        
        if sold > 100:
            promotion += f"\n‚Ä¢ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢: {self._format_sold_count(sold)} ‡∏ä‡∏¥‡πâ‡∏ô"

        if benefits:
            promotion += f"\n\n‚úÖ ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô:\n‚Ä¢ {random.choice(benefits)}"
            if len(benefits) > 1:
                promotion += f"\n‚Ä¢ {random.choice([b for b in benefits if b != benefits[0]])}"

        promotion += f"\n\nüìù ‡∏™‡∏£‡∏∏‡∏õ: {random.choice(self.price_phrases)}"
        promotion += f"\n{random.choice(self.natural_endings)}"
        
        return promotion

    def _shorten_product_name(self, name: str) -> str:
        """‡∏¢‡πà‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢"""
        if len(name) <= 50:
            return name
            
        # ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
        name = name.replace('„Äê', '').replace('„Äë', '')
        name = name.replace('‚ú®', '').replace('üî•', '')
        
        # ‡πÅ‡∏¢‡∏Å‡∏Ñ‡∏≥‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
        words = name.split()
        if len(words) <= 8:
            return name
            
        # ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏î‡πâ‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤
        important_words = words[:6]
        return ' '.join(important_words) + '...'

    def _get_category_benefits(self, category: str) -> List[str]:
        """‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà"""
        category_map = {
            '‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á': '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏°‡∏ß',
            '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡∏≤‡∏°': '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡∏≤‡∏°',
            '‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û': '‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û',
            '‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå': '‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå'
        }
        
        benefit_key = category_map.get(category, '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏°‡∏ß')
        return self.product_benefits.get(benefit_key, self.product_benefits['‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏°‡∏ß'])

    def _format_sold_count(self, count: int) -> str:
        """‡πÅ‡∏õ‡∏•‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢"""
        if count >= 10000:
            return f"{count//1000}k+"
        elif count >= 1000:
            return f"{count//100}00+"
        else:
            return str(count)

    def generate_multiple_promotions(self, product: Dict, count: int = 3) -> List[str]:
        """‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ï‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö"""
        styles = ["casual", "enthusiastic", "informative"]
        promotions = []
        
        for i in range(count):
            style = styles[i % len(styles)]
            promotion = self.generate_promotion(product, style)
            promotions.append(promotion)
            
        return promotions